<mat-accordion>
  <mat-expansion-panel class="mat-elevation-z0" [expanded]="true">
    <mat-expansion-panel-header [collapsedHeight]="'auto'" [expandedHeight]="'auto'">
      <span class="mat-content-label">Result</span>
    </mat-expansion-panel-header>

    <br>
    <form class="result-search" #resultForm = "ngForm" [formGroup]="resultFormGroup">

      <div class="row">
        <div class="col-lg-6 col-md-6 col-sm-6">
          <div>
            <div class="contol-label col-lg-3 col-md-3 col-sm-3" style="float: left;">
              <label class="input-label">Bill Branch</label>
            </div>
            <!-- <div class=" col-lg-1 col-md-1 col-sm-1" style="float: left;">:</div> -->
            <div class=" col-lg-5 col-md-5 col-sm-5" style="float: left">
              <label class="label-value">{{searchResult?.billBr}}</label>
            </div>
          </div>
        </div>

        <div class="col-lg-6 col-md-6 col-sm-6">
          <div>
            <div class="contol-label col-lg-3 col-md-3 col-sm-3" style="float: left;">
              <label class="input-label">GST Applied</label>
            </div>
            <!-- <div class=" col-lg-1 col-md-1 col-sm-1" style="float: left;">:</div> -->

            <div class=" col-lg-3 col-md-3 col-sm-3" style="float: left;padding-left: 5px;">
              <mat-checkbox class="checkbox-margin" (change)="removeOrAddTax()" formControlName="billGstCheck"></mat-checkbox>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6 col-md-6 col-sm-6">
          <div>
            <div class="contol-label col-lg-3 col-md-3 col-sm-3" style="float: left;">
              <label class="input-label">Bill To Address</label>
            </div>
            <!-- <div class=" col-lg-1 col-md-1 col-sm-1" style="float: left;">:</div> -->

            <div class=" col-lg-5 col-md-5 col-sm-5" style="float: left">
              <label class="label-value">{{searchResult?.billToAddr}}</label>
            </div>
          </div>
        </div>
        <div class="col-lg-6 col-md-6 col-sm-6">
          <div>
            <div class="contol-label col-lg-3 col-md-3 col-sm-3" style="float: left;">
              <label class=" input-label">Payment Term</label>
            </div>
            <!-- <div class=" col-lg-1 col-md-1 col-sm-1" style="float: left;">:</div> -->

            <div class=" col-lg-3 col-md-3 col-sm-3" style="float: left">
              <label class="label-value">{{searchResult?.pymtTerm}}</label>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6 col-md-6 col-sm-6">
          <div>
            <div class="contol-label col-lg-3 col-md-3 col-sm-3" style="float: left;">
              <label class=" input-label">Collection Branch</label>
            </div>
            <!-- <div class=" col-lg-1 col-md-1 col-sm-1" style="float: left;">:</div> -->

            <div class=" col-lg-5 col-md-5 col-sm-5" style="float: left">
              <label class="label-value">{{searchResult?.collBr}}</label>
            </div>
          </div>
        </div>

        <div class="col-lg-6 col-md-6 col-sm-6">
          <div>
            <div class="contol-label col-lg-3 col-md-3 col-sm-3" style="float: left;">
              <label class="input-label">Contract End Date</label>
            </div>
            <!-- <div class=" col-lg-1 col-md-1 col-sm-1" style="float: left;">:</div> -->

            <div class=" col-lg-3 col-md-3 col-sm-3" style="float: left">
              <label class="label-value">{{searchResult?.contractEndDate | customDate}}</label>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6 col-md-6 col-sm-6">
          <div>
            <div class="contol-label col-lg-3 col-md-3 col-sm-3" style="float: left;">
              <label class=" input-label">Submission Branch</label>
            </div>
            <!-- <div class=" col-lg-1 col-md-1 col-sm-1" style="float: left;">:</div> -->

            <div class=" col-lg-5 col-md-5 col-sm-5" style="float: left">
              <label class="label-value">{{searchResult?.submsnBr}}</label>
            </div>
          </div>
        </div>
        <div class="col-lg-6 col-md-6 col-sm-6">
          <div>
            <div class="contol-label col-lg-3 col-md-3 col-sm-3" style="float: left;">
              <label class="asterisk-if-mandatory input-label">Bill Date</label>
            </div>
            <!-- <div class=" col-lg-1 col-md-1 col-sm-1" style="float: left;">:</div> -->

            <div class=" col-lg-3 col-md-3 col-sm-3" style="float: left">
              <mat-form-field appearance="outline" class="no-padding">
                <input matInput  [max]="todayDate" class="date-form-control" [matDatepicker]="picker"
                  formControlName="billDateFc" placeholder="DD-MMM-YYYY">
                <mat-datepicker-toggle matPrefix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker panelClass="safexDatePicker" #picker></mat-datepicker>
              </mat-form-field>
              <div class="error"
              *ngIf="resultFormGroup.controls.billDateFc.invalid && (resultFormGroup.controls.billDateFc.dirty || resultFormGroup.controls.billDateFc.touched)">
              <div class="error" *ngIf="resultFormGroup.controls.billDateFc.errors.date"> Invalid Date</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6 col-md-6 col-sm-6">
          <div>
            <div class="contol-label col-lg-3 col-md-3 col-sm-3" style="float: left;">
              <label class="asterisk-if-mandatory input-label">Bill Period</label>
            </div>
            <!-- <div class=" col-lg-1 col-md-1 col-sm-1" style="float: left;">:</div> -->

            <div class="col-lg-3" style="float: left">
              <label class="label-value">From</label>
              <mat-form-field appearance="outline" class="no-padding">
                <input matInput  class="date-form-control" [matDatepicker]="picker1"
                  formControlName="billPeriodFromFc" (dateChange)="setDateValue($event)" placeholder="DD-MMM-YYYY">
                <mat-datepicker-toggle matPrefix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker panelClass="safexDatePicker" #picker1></mat-datepicker>
              </mat-form-field>
              <div class="error"
              *ngIf="resultFormGroup.controls.billPeriodFromFc.invalid && (resultFormGroup.controls.billPeriodFromFc.dirty || resultFormGroup.controls.billPeriodFromFc.touched)">
              <div class="error" *ngIf="resultFormGroup.controls.billPeriodFromFc.errors.date"> Invalid Date</div>
              </div>
            </div>
            <div class="col-lg-3" style="float: left">
              <label class="label-value">To</label>
              <mat-form-field appearance="outline" class="no-padding">
                <input matInput [min]="toDateValue" [max]="lastDateValue" class="date-form-control" [matDatepicker]="picker2"
                  formControlName="billPeriodToFc" placeholder="DD-MMM-YYYY">
                <mat-datepicker-toggle matPrefix [for]="picker2"></mat-datepicker-toggle>
                <mat-datepicker panelClass="safexDatePicker" #picker2></mat-datepicker>
              </mat-form-field>
              <div class="error"
              *ngIf="resultFormGroup.controls.billPeriodToFc.invalid && (resultFormGroup.controls.billPeriodToFc.dirty || resultFormGroup.controls.billPeriodToFc.touched)">
              <div class="error" *ngIf="resultFormGroup.controls.billPeriodToFc.errors.date"> Invalid Date</div>
              </div>
            </div>

          </div>
        </div>
      </div>
      <button *ngIf="writeAccess" mat-icon-button aria-label="Add" (click)="addNewRow()">
        <mat-icon color="primary">add_circle</mat-icon>
      </button>

      <div class="data-container mat-elevation-z">
          <mat-table [dataSource]="dataSource" class="mat-elevation-z0">
          <ng-container matColumnDef="lineNumber">
            <mat-header-cell *matHeaderCellDef><b>Line Number</b></mat-header-cell>
            <mat-cell *matCellDef="let element" data-label="Line Number">
              {{element.lineNumber}}
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="taxTotLbl">
            <mat-footer-cell *matFooterCellDef >Tax Amount</mat-footer-cell>
          </ng-container>
          <ng-container matColumnDef="finTotLbl">
            <mat-footer-cell *matFooterCellDef >Total Amount</mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="service">
            <mat-header-cell *matHeaderCellDef><b>Service Provided</b></mat-header-cell>
            <mat-cell *matCellDef="let element" data-label="Service Provided">
              <ng-select *ngIf="!element.isTotColumn" appendTo="body" name="serviceName" style="min-width: 100%;" appearance="outline"
                [items]="serviceProvidedList" bindLabel="serviceName" bindValue="serviceName"
                [ngModelOptions]="{standalone: true}" [(ngModel)]="element.serviceName" [clearable]="false"
                placeholder="SELECT SERVICE">
              </ng-select>
          </mat-cell>
          </ng-container>

          <ng-container matColumnDef="taxService">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="finService">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>
          <ng-container matColumnDef="amount">
            <mat-header-cell *matHeaderCellDef><b>Amount</b></mat-header-cell>
            <mat-cell  *matCellDef="let element index as i" data-label="Line Amount">
               <input *ngIf="!element.isTotColumn" style="text-align: right;" maxlength="15" class="form-control input-md1 amount-text-padding" matInput type="number"
                [(ngModel)]="element.lineAmt" [ngModelOptions]="{standalone: true}" (change)="calcTax(i)"
                placeholder="Amount" />
          </mat-cell>
          </ng-container>

          <ng-container matColumnDef="taxAmt">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="finAmt">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>
          <ng-container matColumnDef="remarks">
            <mat-header-cell *matHeaderCellDef><b>Remarks</b></mat-header-cell>
            <mat-cell *matCellDef="let element" data-label="Remarks">
              <input *ngIf="!element.isTotColumn" maxlength="255" class="form-control input-md1" matInput placeholder="Remarks"
                [(ngModel)]="element.remarks" [ngModelOptions]="{standalone: true}" />
          </mat-cell>
          </ng-container>


          <ng-container matColumnDef="taxRemarks">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="finRemarks">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>
          <ng-container matColumnDef="sgst">
            <mat-header-cell *matHeaderCellDef><b>SGST</b></mat-header-cell>
            <mat-cell *matCellDef="let element" data-label="SGST">{{element.sgstAmt}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="sgstTot">
            <mat-footer-cell *matFooterCellDef >{{getSgstTotal().toFixed(2)}}</mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="finSgst">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>
          <ng-container matColumnDef="cgst">
            <mat-header-cell *matHeaderCellDef><b>CGST</b></mat-header-cell>
            <mat-cell *matCellDef="let element" data-label="CGST">{{element.cgstAmt}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="cgstTot">
            <mat-footer-cell *matFooterCellDef >{{getCgstTotal().toFixed(2)}}</mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="finCgst">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="igst">
            <mat-header-cell *matHeaderCellDef><b>IGST</b></mat-header-cell>
            <mat-cell *matCellDef="let element" data-label="IGST">{{element.igstAmt}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="igstTot">
            <mat-footer-cell *matFooterCellDef >{{getIgstTotal().toFixed(2)}}</mat-footer-cell>
          </ng-container>


          <ng-container matColumnDef="finIgst">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="total">
            <mat-header-cell *matHeaderCellDef><b>Total</b></mat-header-cell>
            <mat-cell *matCellDef="let element" data-label="TOTAL">{{element.ttlTaxAmt}}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="taxTot">
            <mat-footer-cell *matFooterCellDef >{{getTaxTotal().toFixed(2)}}</mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="finTot">
            <mat-footer-cell *matFooterCellDef >{{getFinTotal()}}</mat-footer-cell>
          </ng-container>

          <ng-container matColumnDef="delete">
            <mat-header-cell *matHeaderCellDef> <b>Delete</b></mat-header-cell>
            <mat-cell *matCellDef="let element;index as i" data-label="Delete Flag">
              <a *ngIf="!element.isTotColumn" mat-icon-button aria-label="Details" (click)="deleteWmsLines(i)" >
            <mat-icon color="primary">delete</mat-icon>
            </a></mat-cell>
          </ng-container>


          <ng-container matColumnDef="taxDelete">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>
          <ng-container matColumnDef="finDelete">
            <mat-footer-cell *matFooterCellDef ></mat-footer-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="displayedColumns;"></mat-header-row>
          <mat-row [ngClass]="{'row-color-blue' : row.isTotColumn == 'true'}"  *matRowDef="let row; columns: displayedColumns;"></mat-row>
          <mat-footer-row class="sticky-footer row-color-blue" *matFooterRowDef="displayedColumnsTaxTotal;"></mat-footer-row>
          <mat-footer-row class="sticky-footer row-color-blue" *matFooterRowDef="displayedColumnsFinTotal;"></mat-footer-row>

        </mat-table>

        </div>
        <br>
      <div class="row">
        <div class="col-md-12 text-center footer-button-padding" style = "margin-bottom:0.3rem;">
          <button *ngIf="writeAccess" mat-raised-button color="primary" type="submit" (click)="submit()" [disabled] = "!resultForm.form.valid">Submit</button>
          <button mat-raised-button style="margin-left: 0.3rem" class="secondary-btn" (click)="back()">Back</button>
        </div>
      </div>
    </form>
  </mat-expansion-panel>
</mat-accordion>
